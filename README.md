# 末日房東模擬器 v2.0 - Apocalypse Landlord Simulator

一個基於末日殭屍背景的房東租屋經營遊戲，採用**配置驅動的ES6模組化架構**，從單體架構成功重構為現代化模組系統。

## 🎮 遊戲特色

- **末日背景設定**：在殭屍橫行的世界中經營租屋事業
- **策略性租客管理**：平衡5種職業租客的技能與感染風險  
- **深度資源管理**：統一管理食物、建材、醫療、燃料、現金5種資源
- **動態事件系統**：4類事件（隨機、衝突、特殊、腳本）豐富遊戲體驗
- **完整技能系統**：20個技能分為主動、被動、特殊3種類型
- **統一交易框架**：租金、商人、商隊、互助4種交易類型

## 🚀 技術成就：配置驅動模組化架構

### ✅ 已完成：核心基礎設施（70%）

**零依賴核心系統**：
- **DataManager** - 統一資料管理，並行載入配置，智慧後備模式
- **GameState** - 中央狀態管理，深度複製保護，狀態歷史追蹤
- **EventBus** - 事件通信系統，發布訂閱模式，完整除錯功能

**配置驅動體系**：
- **rules.json** - 集中遊戲規則配置，支援熱更新
- **智慧後備模式** - 配置載入失敗時自動使用預設值
- **統一驗證機制** - validators.js 可選驗證系統

**系統整合測試**：
- **main.js** - 應用程式進入點，完整錯誤處理
- **index.html** - 即時系統監控，開發者測試工具

### 🚀 下階段目標：業務邏輯模組（30%）

**實作順序**（基於依賴關係優化）：
1. **ResourceManager** - 資源流轉控制核心
2. **TradeManager** - 統一四種交易系統  
3. **TenantManager** - 租客生命週期管理
4. **SkillManager** - 20個技能執行邏輯
5. **EventManager** - 動態事件觸發處理

## 📁 快速開始

### 推薦遊玩方式
1. **穩定版本**：下載 `src/game-refactored.html`（v1.1完整功能）
2. **開發版本**：訪問 `src/index.html`（v2.0模組化測試版）
3. **使用現代瀏覽器**：Chrome 61+, Firefox 60+, Safari 10.1+

### 基礎設施測試（開發者）
```bash
# 1. Clone 專案
git clone https://github.com/Prysline/apocalypse-landlord-simulator.git

# 2. 開啟測試頁面
# 直接用瀏覽器開啟 src/index.html

# 3. 檢查系統狀態
# 頁面右上角顯示系統運行模式
# 🟢 正常模式 🟡 後備模式 🔴 錯誤狀態
```

## 🎯 當前版本特色 v2.0-beta

### 完整的模組化架構
- **ES6模組系統**：真正的模組化開發體驗，支援並行開發
- **配置驅動設計**：rules.json 集中管理，無硬編碼參數
- **事件驅動通信**：模組間透過EventBus解耦，標準化介面
- **智慧錯誤處理**：配置載入失敗時自動降級，優雅處理異常

### 技術創新亮點
- **零依賴核心架構**：DataManager + GameState + EventBus 完全解耦
- **統一資源管理**：6種獲取渠道 → 中央資源庫 → 7種消費渠道
- **完整狀態追蹤**：50條變更歷史，路徑式狀態存取
- **實時系統監控**：內建統計、日誌、除錯功能

### GitHub Pages 原生支援
- **零建置工具**：直接部署ES6模組，無需編譯或打包
- **現代瀏覽器最佳化**：95.69%瀏覽器支援ES6模組
- **即時熱更新**：修改配置檔案自動生效

## 🎲 遊戲機制深度解析

### 租客系統（5種職業）
- **醫生**：治療感染、健康檢查、醫療生產、急救培訓
- **工人**：專業維修、房間加固、日常維護、建築升級  
- **農夫**：採集加成、種植作物、野外採集、食物保存
- **軍人**：戰鬥加成、夜間警戒、防禦工事、巡邏系統
- **老人**：和諧氛圍、糾紛調解、生活指導、人際網絡

### 資源管理（5種資源）
- **食物** (價值1.5)：房東和租客的基本生存需求
- **建材** (價值3.0)：房屋維修和防禦升級材料  
- **醫療** (價值4.0)：治療疾病和檢測感染必需品
- **燃料** (價值3.0)：維持房屋基本運作的能源
- **現金** (價值1.0)：支付租客服務和應急開支

### 交易系統（4種類型）
- **租金交易**：現金優先 → 資源抵付 → 加固房間額外收益
- **商人交易**：基於租客職業的專業化交易選項
- **商隊交易**：固定的批量物資交換機會
- **互助交易**：租客間自動資源分享和房東交易

### 事件系統（4類事件）
- **隨機事件**：30%基礎機率（殭屍襲擊、商隊過路）
- **衝突事件**：動態機率基於租客滿意度和資源稀缺
- **特殊事件**：條件觸發（醫療緊急、建築危機）  
- **腳本事件**：固定天數或成就里程碑觸發

## 📊 系統狀態監控

遊戲提供即時系統狀態指示器：

- **🟢 模組化系統 v2.0 - 運行中**：所有模組正常載入，完整功能可用
- **🟡 模組化系統 v2.0 - 後備模式**：部分配置載入失敗，使用預設配置
- **🔴 系統啟動失敗**：需要檢查瀏覽器ES6模組支援

## 🔄 重構進展與技術對比

### 架構進化歷程
```
v1.0 單體架構 → v1.1 混合架構 → v2.0 模組化架構
 (4000行)      (功能完整)      (15+模組檔案)
```

### 技術優勢對比
| 特性 | v1.1混合架構 | v2.0模組化架構 |
|------|-------------|---------------|
| 檔案結構 | 1個HTML檔案 | 15+個模組檔案 |
| 開發效率 | 單人開發 | 支援並行開發 |
| 維護性 | 難以維護 | 模組獨立維護 |
| 擴展性 | 耦合度高 | 低耦合高內聚 |
| 配置管理 | 硬編碼 | 配置驅動 |
| 錯誤處理 | 基礎 | 完整降級機制 |
| 測試性 | 困難 | 模組獨立測試 |

### 重構成功指標
- ✅ **功能完整性**：100%原功能保留，新增系統監控
- ✅ **模組化程度**：15+獨立模組，平均200-400行/檔案  
- ✅ **配置驅動**：所有參數來自JSON，零硬編碼
- ✅ **部署相容性**：GitHub Pages原生支援，無需建置工具
- ✅ **開發效率**：支援模組並行開發，即時整合測試

## 🤖 AI輔助開發聲明

本專案採用**人機協作模式**進行開發：

### 技術實作（AI輔助）
- **模組化架構設計**：ES6模組系統、依賴關係設計、介面標準化
- **核心系統實作**：DataManager、GameState、EventBus完整實作  
- **配置驅動體系**：rules.json結構設計、validators.js驗證機制
- **系統整合協調**：main.js應用程式進入點、錯誤處理機制
- **詳細技術文檔**：架構設計、系統流程圖、API說明

### 開發管理（人類主導）  
- **需求分析與優先級**：功能規劃、重構策略、實作順序
- **技術決策與驗證**：架構選擇、工具選型、品質把關
- **使用者體驗設計**：介面規劃、互動流程、遊戲平衡
- **專案管理與規劃**：開發節奏、里程碑、風險控制

## 📚 文件資源

- **[架構設計文件](docs/architecture.md)**：完整的技術架構說明和重構策略
- **[專案結構說明](PROJECT_STRUCTURE.md)**：詳細的檔案組織和開發規劃  
- **[系統流程圖集](docs/flow-diagrams.md)**：6張詳細的系統流程圖表

## 🔧 開發者指南

### 除錯與測試
```javascript
// 瀏覽器控制台除錯命令
gameApp.debug()              // 顯示完整系統狀態
gameApp.dataManager.getSystemStatus()  // 檢查資料管理器
gameApp.gameState.getStateStats()      // 檢查遊戲狀態
gameApp.eventBus.getStats()           // 檢查事件系統

// URL參數啟用除錯模式  
?debug=true                  // 啟用詳細日誌
```

### 配置修改
```javascript
// 修改 rules.json 即時生效
{
  "gameDefaults": {
    "initialResources": {
      "cash": 100  // 修改初始現金
    }
  }
}
```

## 🚧 開發狀態與路線圖

### 當前狀態：基礎設施完成 v2.0-beta
- ✅ **配置驅動核心架構** (100%)
- ✅ **事件驅動通信系統** (100%)  
- ✅ **統一狀態管理機制** (100%)
- ✅ **完整系統整合測試** (100%)
- ✅ **詳細架構設計文檔** (100%)

### 下階段目標：業務邏輯實作 v2.0
- 🚀 **ResourceManager** - 資源流轉控制（下一目標）
- 🚀 **TradeManager** - 統一交易系統
- 🚀 **TenantManager** - 租客生命週期  
- 🚀 **SkillManager** - 技能執行邏輯
- 🚀 **EventManager** - 事件觸發處理

### 未來發展：商業化準備
- 📋 **UI系統現代化** - 響應式介面、動畫效果
- 📋 **效能優化** - 按需載入、記憶體優化
- 📋 **多平台支援** - PWA、Electron桌面版  
- 📋 **雲端功能** - 存檔同步、社交功能

## 🐛 問題回報與貢獻

### 系統問題診斷
1. **檢查系統狀態指示器**（頁面右上角）
2. **開啟瀏覽器開發者工具**查看控制台訊息  
3. **確認瀏覽器支援ES6模組**（Chrome 61+推薦）
4. **參考架構文件**了解系統運作原理

### 貢獻方式
- **問題回報**：GitHub Issues提交詳細錯誤資訊
- **功能建議**：基於現有模組化架構提出擴展想法
- **技術討論**：架構改進、效能優化、新功能設計

## 📄 版權與授權

### 版權聲明
本專案採用保守授權策略，在AI生成內容法律歸屬明確前保留所有權利。

**Copyright © 2024. All Rights Reserved.**

### 使用許可  
- ✅ **個人學習與研究**
- ✅ **學術引用**（需註明來源）
- ✅ **技術參考與討論**
- ❌ **商業使用或分發**
- ❌ **修改後重新發布**

---

**專案狀態**：核心基礎設施完成 v2.0-beta（70%）→ 業務邏輯實作 v2.0（預期完成度95%）  
**技術基礎**：配置驅動ES6模組化架構已驗證穩定  
**開發策略**：人機協作，AI負責技術實作，人類負責需求與決策  
**商業價值**：現代化架構為未來商業化發展奠定堅實技術基礎